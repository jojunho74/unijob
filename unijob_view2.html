<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UniJob View - 채용 데이터 분석</title>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .header {
          background: linear-gradient(135deg, #4A90E2 0%, #357ABD 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .loading-overlay.hidden {
            display: none;
        }

        .loading-content {
            text-align: center;
            color: white;
        }

        .loading-spinner {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #4A90E2;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 20px;
            font-weight: 600;
        }

        .nav-menu {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #e0e0e0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .nav-item {
            flex: 1;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            font-weight: 600;
            font-size: 16px;
            color: #555;
        }

        .nav-item:hover {
            background: #e9ecef;
            color: #4A90E2;
        }

        .nav-item.active {
            background: white;
            color: #4A90E2;
            border-bottom-color: #4A90E2;
        }

        .tab-content {
            display: none;
            padding: 30px;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .stats-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        .stat-card h3 {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .stat-card .value {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-card .label {
            font-size: 12px;
            opacity: 0.8;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }

        .chart-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .chart-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }

        .chart-card h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }

        .chart-container {
            position: relative;
            height: 350px;
        }

        .controls {
            margin-bottom: 25px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }

        .search-box {
            flex: 1;
            min-width: 250px;
        }

        .search-box input {
            width: 100%;
            padding: 12px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            font-size: 15px;
            transition: all 0.3s ease;
        }

        .search-box input:focus {
            outline: none;
            border-color: #4A90E2;
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
        }

        .filter-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        select {
            padding: 10px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        select:hover {
            border-color: #4A90E2;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .btn-primary {
            background: #4A90E2;
            color: white;
        }

        .btn-primary:hover {
            background: #357ABD;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        thead {
            background: linear-gradient(135deg, #4A90E2 0%, #357ABD 100%);
            color: white;
        }

        th {
            padding: 18px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            cursor: pointer;
            user-select: none;
            position: relative;
        }

        th:hover {
            background: rgba(255,255,255,0.1);
        }

        th.sortable::after {
            content: '⇅';
            position: absolute;
            right: 8px;
            opacity: 0.5;
        }

        th.sort-asc::after {
            content: '↑';
            opacity: 1;
        }

        th.sort-desc::after {
            content: '↓';
            opacity: 1;
        }

        td {
            padding: 15px 18px;
            border-bottom: 1px solid #f0f0f0;
            color: #333;
        }

        tbody tr {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        tbody tr:nth-child(even) {
            background: #f8f9fa;
        }

        tbody tr:hover {
            background: #e3f2fd;
            transform: scale(1.01);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .job-title-cell {
            max-width: 600px;
            word-wrap: break-word;
            line-height: 1.5;
        }

        .company-link {
            color: #4A90E2;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .company-link:hover {
            color: #357ABD;
            text-decoration: underline;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 700px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .modal-header h2 {
            color: #333;
            font-size: 24px;
        }

        .close-btn {
            font-size: 28px;
            cursor: pointer;
            color: #999;
            transition: color 0.3s ease;
        }

        .close-btn:hover {
            color: #333;
        }

        .modal-body {
            line-height: 1.8;
        }

        .modal-body .info-row {
            display: flex;
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 8px;
            background: #f8f9fa;
        }

        .modal-body .info-label {
            font-weight: 600;
            color: #4A90E2;
            min-width: 120px;
        }

        .modal-body .info-value {
            color: #333;
            flex: 1;
            word-wrap: break-word;
        }

        .top-companies-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .company-item {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s ease;
        }

        .company-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.12);
        }

        .company-rank {
            font-size: 28px;
            font-weight: bold;
            color: #4A90E2;
            min-width: 50px;
        }

        .company-info {
            flex: 1;
        }

        .company-name {
            font-weight: 600;
            font-size: 16px;
            color: #333;
            margin-bottom: 5px;
        }

        .company-count {
            color: #666;
            font-size: 14px;
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 30px;
            padding: 20px;
        }

        .pagination button {
            padding: 10px 20px;
            border: 2px solid #4A90E2;
            background: white;
            color: #4A90E2;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .pagination button:hover:not(:disabled) {
            background: #4A90E2;
            color: white;
        }

        .pagination button:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .pagination .page-info {
            color: #666;
            font-weight: 600;
        }

        .alert {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 3000;
            animation: slideIn 0.3s ease;
            display: none;
        }

        .alert.show {
            display: block;
        }

        @keyframes slideIn {
            from { transform: translateX(400px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border-left: 4px solid #28a745;
        }

        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border-left: 4px solid #dc3545;
        }

        @media (max-width: 768px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }

            .nav-item {
                padding: 15px 10px;
                font-size: 14px;
            }

            .header h1 {
                font-size: 1.8em;
            }

            .stats-overview {
                grid-template-columns: repeat(2, 1fr);
            }

            .filter-group {
                width: 100%;
            }

            select {
                flex: 1;
            }

            .controls {
                flex-direction: column;
            }

            .action-buttons {
                width: 100%;
            }

            .btn {
                flex: 1;
            }

            table {
                font-size: 12px;
            }

            th, td {
                padding: 10px;
            }
        }
    </style>
</head>

<body>
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div class="loading-text">GitHub에서 데이터를 불러오는 중...</div>
        </div>
    </div>

    <div class="container">
        <div class="header">
            <h1>📊 UniJob View</h1>
            <p>채용 데이터 분석 및 시각화 플랫폼</p>
        
</div>

<!-- 플로팅 배너 애니메이션 -->
<style>
@keyframes floatBounce {
    0%, 100% { transform: translateY(-50%); }
    50% { transform: translateY(-55%); }
}

.floating-banner a:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 20px rgba(255, 107, 157, 0.4) !important;
    background: #FFF5F8 !important;
}

/* 모바일 반응형 */
@media (max-width: 768px) {
    .floating-banner {
        right: 15px !important;
        width: 220px !important;
        padding: 20px !important;
    }
    
    .floating-banner h3 {
        font-size: 1.2rem !important;
    }
    
    .floating-banner a {
        font-size: 0.9rem !important;
        padding: 12px 16px !important;
    }
}

/* 화면이 매우 작을 때 하단 고정 */
@media (max-width: 480px) {
    .floating-banner {
        position: fixed !important;
        bottom: 0 !important;
        top: auto !important;
        right: 0 !important;
        left: 0 !important;
        width: 100% !important;
        transform: none !important;
        border-radius: 20px 20px 0 0 !important;
        animation: none !important;
    }
}
</style>

<img src="https://raw.githubusercontent.com/jojunho74/unijob/main/headimgae.png" 

     class="header-image" 
     style="width:100%; height:auto; display:block; margin-bottom:10px;">

        <div class="nav-menu">
            <div class="nav-item active" onclick="showTab('data')">
                📋 데이터
            </div>
            <div class="nav-item" onclick="showTab('statistics')">
                📊 통계 대시보드
            </div>
            <div class="nav-item" onclick="showTab('companies')">
                🏢 기업 분석
            </div>
            <div class="nav-item" onclick="showTab('trends')">
                📈 트렌드 분석
            </div>
        </div>

        <div id="data-tab" class="tab-content active">
            <div class="controls">
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="🔍 기업명, 직무, 지역, 산업 검색..." onkeyup="filterTable()">
                </div>
                <div class="filter-group">
                    <select id="industryFilter" onchange="filterTable()">
                        <option value="">전체 산업</option>
                    </select>
                    <select id="locationFilter" onchange="filterTable()">
                        <option value="">전체 지역</option>
                    </select>
                    <select id="jobTypeFilter" onchange="filterTable()">
                        <option value="">전체 고용형태</option>
                    </select>
                </div>
                <div class="action-buttons">
  
                    <button class="btn btn-secondary" onclick="resetFilters()">🔄 초기화</button>
                </div>
            </div>

            <table id="dataTable">
                <thead>
                    <tr>
                        <th class="sortable" onclick="sortTable(0)">채용관련 기업명</th>
                        <th class="sortable" onclick="sortTable(1)">직무관련 내용</th>
                        <th class="sortable" onclick="sortTable(2)">산업(모집분야별)</th>
                        <th class="sortable" onclick="sortTable(3)">지역</th>
                        <th class="sortable" onclick="sortTable(4)">고용형태</th>
                        <th class="sortable" onclick="sortTable(5)">마감일</th>
                        <th>상세</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <tr>
                        <td colspan="7" style="text-align:center;padding:50px;">데이터 로딩 중...</td>
                    </tr>
                </tbody>
            </table>

            <div class="pagination">
                <button id="prevBtn" onclick="changePage(-1)">이전</button>
                <span class="page-info" id="pageInfo">0 / 0</span>
                <button id="nextBtn" onclick="changePage(1)">다음</button>
            </div>
        </div>

        <div id="statistics-tab" class="tab-content">
            <div class="stats-overview">
                <div class="stat-card">
                    <h3>총 채용공고</h3>
                    <div class="value" id="totalJobs">0</div>
                    <div class="label">건</div>
                </div>
                <div class="stat-card">
                    <h3>참여 기업</h3>
                    <div class="value" id="totalCompanies">0</div>
                    <div class="label">개사</div>
                </div>
                <div class="stat-card">
                    <h3>주요 산업</h3>
                    <div class="value" id="topIndustry">-</div>
                    <div class="label">분야</div>
                </div>
                <div class="stat-card">
                    <h3>채용 지역</h3>
                    <div class="value" id="totalLocations">0</div>
                    <div class="label">개 지역</div>
                </div>
            </div>

            <div class="charts-grid">
                <div class="chart-card">
                    <h3>📊 산업별 채용 분포</h3>
                    <div class="chart-container">
                        <canvas id="industryChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <h3>🏢 기업 규모별 분포</h3>
                    <div class="chart-container">
                        <canvas id="sizeChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <h3>🗺️ 지역별 채용 현황</h3>
                    <div class="chart-container">
                        <canvas id="locationChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <h3>💼 고용 형태 분포</h3>
                    <div class="chart-container">
                        <canvas id="jobTypeChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <h3>🔍 인기 키워드 TOP 10</h3>
                    <div class="chart-container">
                        <canvas id="keywordChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <div id="companies-tab" class="tab-content">
            <div class="chart-card">
                <h3>🏆 TOP 20 채용 기업</h3>
                <div id="topCompaniesList" class="top-companies-list">
                    <div style="text-align:center;padding:50px;color:#999;">데이터 로딩 중...</div>
                </div>
            </div>

            <div class="charts-grid" style="margin-top: 30px;">
                <div class="chart-card">
                    <h3>📊 기업별 채용 공고 수</h3>
                    <div class="chart-container">
                        <canvas id="companyChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <h3>🔄 산업 × 기업규모 분포</h3>
                    <div class="chart-container">
                        <canvas id="crossChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <div id="trends-tab" class="tab-content">
            <div class="charts-grid">
                <div class="chart-card">
                    <h3>📅 수집 시기별 채용 추이</h3>
                    <div class="chart-container">
                        <canvas id="collectionChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <h3>⏰ 마감 기한 분포</h3>
                    <div class="chart-container">
                        <canvas id="deadlineChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
    </div>  <!-- 817번 라인: 트렌드 탭 닫기 -->

        </div>
    </div>
    <div id="detailModal" class="modal">  <!-- 819번 라인 -->
    <div id="detailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>채용 상세 정보</h2>
                <span class="close-btn" onclick="closeModal()">&times;</span>
            </div>
            <div class="modal-body" id="modalBody"></div>
        </div>
    </div>

    <div id="alertBox" class="alert"></div>

    <script>
        const GITHUB_JSON_URL = 'https://raw.githubusercontent.com/jojunho74/unijob/refs/heads/main/major_corp_jobs_1761096901335.json';
        
        let jobsData = [];
        let filteredData = [];
        let charts = {};
        let currentPage = 1;
        let sortColumn = -1;
        let sortDirection = 'asc';
        const itemsPerPage = 50;

        // 페이지 로드 시 자동으로 JSON 가져오기
        window.addEventListener('DOMContentLoaded', () => {
            loadDataFromGitHub();
        });

        async function loadDataFromGitHub() {
            try {
                const response = await fetch(GITHUB_JSON_URL);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                jobsData = await response.json();
                filteredData = [...jobsData];
                
                document.getElementById('loadingOverlay').classList.add('hidden');
                
                initializeAll();
                showAlert(`✅ ${jobsData.length.toLocaleString()}개 데이터 로드 완료!`, 'success');
            } catch (error) {
                document.getElementById('loadingOverlay').classList.add('hidden');
                showAlert('❌ 데이터 로드 실패: ' + error.message, 'error');
                console.error('Error loading data:', error);
            }
        }

        function initializeAll() {
            populateFilters();
            renderTable();
            calculateStats();
        }

        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });

            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');

            if (tabName === 'statistics' && !charts.industry) {
                createStatisticsCharts();
            } else if (tabName === 'companies' && !charts.company) {
                createCompanyCharts();
            } else if (tabName === 'trends' && !charts.collection) {
                createTrendCharts();
            }
        }

        function populateFilters() {
            const industries = [...new Set(jobsData.map(j => j.industry).filter(x => x))].sort();
            const locations = [...new Set(jobsData.map(j => j.location).filter(x => x))].sort();
            const jobTypes = [...new Set(jobsData.map(j => j.jobType).filter(x => x))].sort();

            populateSelect('industryFilter', industries);
            populateSelect('locationFilter', locations);
            populateSelect('jobTypeFilter', jobTypes);
        }

        function populateSelect(id, options) {
            const select = document.getElementById(id);
            select.innerHTML = '<option value="">전체</option>';
            options.forEach(opt => {
                const option = document.createElement('option');
                option.value = opt;
                option.textContent = opt;
                select.appendChild(option);
            });
        }

        function renderTable() {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';

            const start = (currentPage - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            const pageData = filteredData.slice(start, end);

            if (pageData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align:center;padding:50px;color:#999;">검색 결과가 없습니다.</td></tr>';
                updatePagination();
                return;
            }

            pageData.forEach((job, index) => {
                const row = document.createElement('tr');
                row.onclick = () => showDetail(job);

                row.innerHTML = `
                    <td><a href="${job.jobUrl || '#'}" class="company-link" target="_blank" onclick="event.stopPropagation()">${job.companyName || '미등록'}</a></td>
                    <td class="job-title-cell">${job.jobTitle || '미등록'}</td>
                    <td>${job.industry || '미등록'}</td>
                    <td>${job.location || '미등록'}</td>
                    <td>${job.jobType || '미등록'}</td>
                    <td>${job.deadline || '미정'}</td>
                    <td><button class="btn btn-primary" style="padding: 5px 10px; font-size: 12px;" onclick="event.stopPropagation(); showDetail(filteredData[${start + index}])">상세</button></td>
                `;
                tbody.appendChild(row);
            });

            updatePagination();
        }

        function showDetail(job) {
            const modal = document.getElementById('detailModal');
            const modalBody = document.getElementById('modalBody');
            
            modalBody.innerHTML = `
                <div class="info-row">
                    <div class="info-label">ID</div>
                    <div class="info-value">${job.id || '-'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">기업명</div>
                    <div class="info-value">${job.companyName || '미등록'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">직무</div>
                    <div class="info-value">${job.jobTitle || '미등록'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">기업 규모</div>
                    <div class="info-value">${job.companySize || '미등록'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">기업 유형</div>
                    <div class="info-value">${job.companyType || '미등록'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">산업</div>
                    <div class="info-value">${job.industry || '미등록'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">직원 수</div>
                    <div class="info-value">${job.employeeCount || '미등록'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">지역</div>
                    <div class="info-value">${job.location || '미등록'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">고용 형태</div>
                    <div class="info-value">${job.jobType || '미등록'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">마감일</div>
                    <div class="info-value">${job.deadline || '미정'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">급여</div>
                    <div class="info-value">${job.salary || '협의'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">키워드</div>
                    <div class="info-value">${job.keywordMatched || '-'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">수집 시간</div>
                    <div class="info-value">${job.collectionTime || '-'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">채용 URL</div>
                    <div class="info-value"><a href="${job.jobUrl || '#'}" target="_blank" class="company-link">링크 열기</a></div>
                </div>
            `;
            
            modal.classList.add('active');
        }

        function closeModal() {
            document.getElementById('detailModal').classList.remove('active');
        }

        window.onclick = function(event) {
            const modal = document.getElementById('detailModal');
            if (event.target === modal) {
                closeModal();
            }
        }

        function sortTable(columnIndex) {
            if (sortColumn === columnIndex) {
                sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                sortColumn = columnIndex;
                sortDirection = 'asc';
            }

            const columns = ['companyName', 'jobTitle', 'industry', 'location', 'jobType', 'deadline'];
            const column = columns[columnIndex];

            filteredData.sort((a, b) => {
                let valA = a[column] || '';
                let valB = b[column] || '';
                
                if (sortDirection === 'asc') {
                    return valA.localeCompare(valB);
                } else {
                    return valB.localeCompare(valA);
                }
            });

            document.querySelectorAll('th').forEach((th, index) => {
                th.classList.remove('sort-asc', 'sort-desc');
                if (index === columnIndex) {
                    th.classList.add(sortDirection === 'asc' ? 'sort-asc' : 'sort-desc');
                }
            });

            currentPage = 1;
            renderTable();
        }

        function updatePagination() {
            const totalPages = Math.ceil(filteredData.length / itemsPerPage);
            document.getElementById('pageInfo').textContent = `${currentPage} / ${totalPages || 1}`;
            document.getElementById('prevBtn').disabled = currentPage === 1;
            document.getElementById('nextBtn').disabled = currentPage === totalPages || totalPages === 0;
        }

        function changePage(direction) {
            const totalPages = Math.ceil(filteredData.length / itemsPerPage);
            const newPage = currentPage + direction;
            
            if (newPage >= 1 && newPage <= totalPages) {
                currentPage = newPage;
                renderTable();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function filterTable() {
            const searchText = document.getElementById('searchInput').value.toLowerCase();
            const industryFilter = document.getElementById('industryFilter').value;
            const locationFilter = document.getElementById('locationFilter').value;
            const jobTypeFilter = document.getElementById('jobTypeFilter').value;

            filteredData = jobsData.filter(job => {
                const matchSearch = !searchText || 
                    (job.companyName || '').toLowerCase().includes(searchText) ||
                    (job.jobTitle || '').toLowerCase().includes(searchText) ||
                    (job.location || '').toLowerCase().includes(searchText) ||
                    (job.industry || '').toLowerCase().includes(searchText);
                
                const matchIndustry = !industryFilter || job.industry === industryFilter;
                const matchLocation = !locationFilter || job.location === locationFilter;
                const matchJobType = !jobTypeFilter || job.jobType === jobTypeFilter;

                return matchSearch && matchIndustry && matchLocation && matchJobType;
            });

            currentPage = 1;
            renderTable();
        }

        function resetFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('industryFilter').value = '';
            document.getElementById('locationFilter').value = '';
            document.getElementById('jobTypeFilter').value = '';
            filterTable();
        }

        function downloadCSV() {
            const headers = ['ID', '기업명', '직무', '규모', '유형', '산업', '직원수', '지역', '고용형태', '마감일', '급여', 'URL', '키워드', '수집시간'];
            const csvContent = [
                headers.join(','),
                ...filteredData.map(job => [
                    job.id,
                    job.companyName,
                    job.jobTitle,
                    job.companySize,
                    job.companyType,
                    job.industry,
                    job.employeeCount,
                    job.location,
                    job.jobType,
                    job.deadline,
                    job.salary,
                    job.jobUrl,
                    job.keywordMatched,
                    job.collectionTime
                ].map(field => `"${field || ''}"`).join(','))
            ].join('\n');

            const BOM = '\uFEFF';
            const blob = new Blob([BOM + csvContent], { type: 'text/csv;charset=utf-8;' });
            downloadBlob(blob, `unijob_filtered_${Date.now()}.csv`);
            showAlert('✅ CSV 파일 다운로드 완료!', 'success');
        }

        function downloadJSON() {
            const jsonString = JSON.stringify(filteredData, null, 2);
            const blob = new Blob([jsonString], { type: 'application/json' });
            downloadBlob(blob, `unijob_filtered_${Date.now()}.json`);
            showAlert('✅ JSON 파일 다운로드 완료!', 'success');
        }

        function downloadBlob(blob, filename) {
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            link.click();
            URL.revokeObjectURL(url);
        }

        function calculateStats() {
            const totalJobs = jobsData.length;
            const uniqueCompanies = [...new Set(jobsData.map(j => j.companyName).filter(x => x))].length;
            const uniqueLocations = [...new Set(jobsData.map(j => j.location).filter(x => x))].length;
            
            const industryCounts = {};
            jobsData.forEach(job => {
                if (job.industry) {
                    industryCounts[job.industry] = (industryCounts[job.industry] || 0) + 1;
                }
            });
            
            const topIndustry = Object.keys(industryCounts).length > 0 ?
                Object.keys(industryCounts).reduce((a, b) => industryCounts[a] > industryCounts[b] ? a : b) : '-';

            document.getElementById('totalJobs').textContent = totalJobs.toLocaleString();
            document.getElementById('totalCompanies').textContent = uniqueCompanies.toLocaleString();
            document.getElementById('topIndustry').textContent = topIndustry;
            document.getElementById('totalLocations').textContent = uniqueLocations;
        }

        function createStatisticsCharts() {
            createIndustryChart();
            createSizeChart();
            createLocationChart();
            createJobTypeChart();
            createKeywordChart();
        }

        function createIndustryChart() {
            const industryCounts = {};
            jobsData.forEach(job => {
                if (job.industry) {
                    industryCounts[job.industry] = (industryCounts[job.industry] || 0) + 1;
                }
            });

            const ctx = document.getElementById('industryChart');
            charts.industry = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: Object.keys(industryCounts),
                    datasets: [{
                        data: Object.values(industryCounts),
                        backgroundColor: [
                            '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0',
                            '#9966FF', '#FF9F40', '#FF6384', '#C9CBCF', '#4BC0C0'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'right' } }
                }
            });
        }

        function createSizeChart() {
            const sizeCounts = {};
            jobsData.forEach(job => {
                if (job.companySize) {
                    sizeCounts[job.companySize] = (sizeCounts[job.companySize] || 0) + 1;
                }
            });

            const ctx = document.getElementById('sizeChart');
            charts.size = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(sizeCounts),
                    datasets: [{
                        data: Object.values(sizeCounts),
                        backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'right' } }
                }
            });
        }

        function createLocationChart() {
            const locationCounts = {};
            jobsData.forEach(job => {
                if (job.location) {
                    locationCounts[job.location] = (locationCounts[job.location] || 0) + 1;
                }
            });

            const sortedLocations = Object.entries(locationCounts)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10);

            const ctx = document.getElementById('locationChart');
            charts.location = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: sortedLocations.map(l => l[0]),
                    datasets: [{
                        label: '채용 공고 수',
                        data: sortedLocations.map(l => l[1]),
                        backgroundColor: '#4A90E2'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { y: { beginAtZero: true } }
                }
            });
        }

        function createJobTypeChart() {
            const typeCounts = {};
            jobsData.forEach(job => {
                if (job.jobType) {
                    typeCounts[job.jobType] = (typeCounts[job.jobType] || 0) + 1;
                }
            });

            const ctx = document.getElementById('jobTypeChart');
            charts.jobType = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: Object.keys(typeCounts),
                    datasets: [{
                        data: Object.values(typeCounts),
                        backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#FF9F40']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'right' } }
                }
            });
        }

        function createKeywordChart() {
            const keywordCounts = {};
            jobsData.forEach(job => {
                if (job.keywordMatched) {
                    keywordCounts[job.keywordMatched] = (keywordCounts[job.keywordMatched] || 0) + 1;
                }
            });

            const sortedKeywords = Object.entries(keywordCounts)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10);

            const ctx = document.getElementById('keywordChart');
            charts.keyword = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: sortedKeywords.map(k => k[0]),
                    datasets: [{
                        label: '매칭 수',
                        data: sortedKeywords.map(k => k[1]),
                        backgroundColor: '#9966FF'
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { x: { beginAtZero: true } }
                }
            });
        }

        function createCompanyCharts() {
            const companyCounts = {};
            jobsData.forEach(job => {
                if (job.companyName) {
                    companyCounts[job.companyName] = (companyCounts[job.companyName] || 0) + 1;
                }
            });

            const sortedCompanies = Object.entries(companyCounts)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 20);

            const listContainer = document.getElementById('topCompaniesList');
            listContainer.innerHTML = '';
            
            sortedCompanies.forEach(([company, count], index) => {
                const item = document.createElement('div');
                item.className = 'company-item';
                item.innerHTML = `
                    <div class="company-rank">#${index + 1}</div>
                    <div class="company-info">
                        <div class="company-name">${company}</div>
                        <div class="company-count">${count}개 채용공고</div>
                    </div>
                `;
                listContainer.appendChild(item);
            });

            const ctx = document.getElementById('companyChart');
            charts.company = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: sortedCompanies.map(c => c[0]),
                    datasets: [{
                        label: '채용 공고 수',
                        data: sortedCompanies.map(c => c[1]),
                        backgroundColor: '#FF6384'
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { x: { beginAtZero: true } }
                }
            });

            createCrossAnalysisChart();
        }

        function createCrossAnalysisChart() {
            const crossData = {};
            jobsData.forEach(job => {
                if (job.industry && job.companySize) {
                    const key = `${job.industry}_${job.companySize}`;
                    crossData[key] = (crossData[key] || 0) + 1;
                }
            });

            const industries = [...new Set(jobsData.map(j => j.industry).filter(x => x))].slice(0, 6);
            const sizes = [...new Set(jobsData.map(j => j.companySize).filter(x => x))].slice(0, 4);

            const datasets = sizes.map((size, index) => ({
                label: size,
                data: industries.map(ind => crossData[`${ind}_${size}`] || 0),
                backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0'][index]
            }));

            const ctx = document.getElementById('crossChart');
            charts.cross = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: industries,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'top' } },
                    scales: { y: { beginAtZero: true } }
                }
            });
        }

        function createTrendCharts() {
            createCollectionChart();
            createDeadlineChart();
        }

        function createCollectionChart() {
            const collectionDates = {};
            jobsData.forEach(job => {
                if (job.collectionTime) {
                    const date = job.collectionTime.split(' ')[0];
                    collectionDates[date] = (collectionDates[date] || 0) + 1;
                }
            });

            const sortedDates = Object.entries(collectionDates).sort();

            const ctx = document.getElementById('collectionChart');
            charts.collection = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: sortedDates.map(d => d[0]),
                    datasets: [{
                        label: '수집 공고 수',
                        data: sortedDates.map(d => d[1]),
                        borderColor: '#36A2EB',
                        backgroundColor: 'rgba(54, 162, 235, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { y: { beginAtZero: true } }
                }
            });
        }

        function createDeadlineChart() {
            const deadlineCounts = {
                'D-7 이내': 0,
                'D-14 이내': 0,
                'D-30 이내': 0,
                '상시채용': 0,
                '미정': 0
            };

            jobsData.forEach(job => {
                if (!job.deadline || job.deadline.includes('TBD')) {
                    deadlineCounts['미정']++;
                } else if (job.deadline.includes('D-')) {
                    const match = job.deadline.match(/D-(\d+)/);
                    if (match) {
                        const days = parseInt(match[1]);
                        if (days <= 7) deadlineCounts['D-7 이내']++;
                        else if (days <= 14) deadlineCounts['D-14 이내']++;
                        else if (days <= 30) deadlineCounts['D-30 이내']++;
                        else deadlineCounts['상시채용']++;
                    }
                } else {
                    deadlineCounts['상시채용']++;
                }
            });

            const ctx = document.getElementById('deadlineChart');
            charts.deadline = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(deadlineCounts),
                    datasets: [{
                        data: Object.values(deadlineCounts),
                        backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'right' } }
                }
            });
        }

        function showAlert(message, type) {
            const alertBox = document.getElementById('alertBox');
            alertBox.className = `alert alert-${type} show`;
            alertBox.textContent = message;
            
            setTimeout(() => {
                alertBox.classList.remove('show');
            }, 3000);
        }
    </script>
</body>
<!-- 조회수 카운터 (기존 스크립트 전체를 이것으로 교체) -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // URL에서 공고 ID 추출
    const urlParams = new URLSearchParams(window.location.search);
    const jobId = urlParams.get('id') || 'unknown';
    
    // 현재 날짜와 시간
    const now = new Date();
    const today = now.toISOString().split('T')[0]; // YYYY-MM-DD 형식
    const timestamp = now.toISOString();
    
    // === 1. 일자별 조회수 기록 ===
    const dailyKey = `daily_views_${today}`;
    let dailyViews = JSON.parse(localStorage.getItem(dailyKey) || '{}');
    
    if (!dailyViews[jobId]) {
        dailyViews[jobId] = 0;
    }
    dailyViews[jobId]++;
    
    localStorage.setItem(dailyKey, JSON.stringify(dailyViews));
    
    // === 2. 전체 일자 목록 관리 ===
    let allDates = JSON.parse(localStorage.getItem('tracked_dates') || '[]');
    if (!allDates.includes(today)) {
        allDates.push(today);
        allDates.sort(); // 날짜 순으로 정렬
        localStorage.setItem('tracked_dates', JSON.stringify(allDates));
    }
    
    // === 3. 상세 조회 로그 (시간까지 기록) ===
    const viewLog = {
        jobId: jobId,
        date: today,
        timestamp: timestamp,
        url: window.location.href
    };
    
    let allViews = JSON.parse(localStorage.getItem('allJobViews') || '[]');
    allViews.push(viewLog);
    
    // 최근 1000개만 유지
    if (allViews.length > 1000) {
        allViews = allViews.slice(-1000);
    }
    localStorage.setItem('allJobViews', JSON.stringify(allViews));
    
    // === 4. 공고별 누적 조회수 ===
    const storageKey = `job_view_count_${jobId}`;
    let viewCount = parseInt(localStorage.getItem(storageKey) || '0');
    viewCount++;
    localStorage.setItem(storageKey, viewCount);
    
    // === 5. 전체 누적 조회수 ===
    let totalViews = parseInt(localStorage.getItem('total_views') || '0');
    totalViews++;
    localStorage.setItem('total_views', totalViews);
    
    // === 6. 오늘 전체 조회수 ===
    const todayTotalKey = `daily_total_${today}`;
    let todayTotal = parseInt(localStorage.getItem(todayTotalKey) || '0');
    todayTotal++;
    localStorage.setItem(todayTotalKey, todayTotal);
    
    console.log(`📊 조회 기록: ${jobId} | 오늘 ${dailyViews[jobId]}회 | 누적 ${viewCount}회`);
    
    // 관리자 단축키: Ctrl + Shift + V
    document.addEventListener('keydown', function(e) {
        if (e.ctrlKey && e.shiftKey && e.key === 'V') {
            showAdminStats();
        }
    });
});

// 관리자 통계 표시 함수
function showAdminStats() {
    const urlParams = new URLSearchParams(window.location.search);
    const jobId = urlParams.get('id') || 'unknown';
    const today = new Date().toISOString().split('T')[0];
    
    // 오늘 이 공고 조회수
    const dailyViews = JSON.parse(localStorage.getItem(`daily_views_${today}`) || '{}');
    const todayCount = dailyViews[jobId] || 0;
    
    // 누적 조회수
    const totalCount = localStorage.getItem(`job_view_count_${jobId}`) || '0';
    
    // 오늘 전체 조회수
    const todayTotal = localStorage.getItem(`daily_total_${today}`) || '0';
    
    // 전체 누적 조회수
    const grandTotal = localStorage.getItem('total_views') || '0';
    
    let statsText = `📊 조회 통계 (${today})\n\n`;
    statsText += `🔹 현재 공고 (ID: ${jobId})\n`;
    statsText += `   오늘: ${todayCount}회\n`;
    statsText += `   누적: ${totalCount}회\n\n`;
    statsText += `🔹 전체 통계\n`;
    statsText += `   오늘 전체: ${todayTotal}회\n`;
    statsText += `   누적 전체: ${grandTotal}회\n\n`;
    statsText += `💡 상세 통계 페이지로 이동하시겠습니까?`;
    
    if (confirm(statsText)) {
        window.open('admin_stats.html', '_blank');
    }
}
</script>
</html>