<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UniJob View2 - JSON ë°ì´í„° ë·°ì–´</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4A90E2 0%, #357ABD 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .file-upload-bar {
            background: #f8f9fa;
            padding: 15px 30px;
            border-bottom: 2px solid #e0e0e0;
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .file-upload-btn {
            padding: 10px 20px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .file-upload-btn:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        .file-name {
            color: #666;
            font-size: 14px;
        }

        .data-count {
            margin-left: auto;
            color: #4A90E2;
            font-weight: 600;
            font-size: 16px;
        }

        .nav-menu {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #e0e0e0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .nav-item {
            flex: 1;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            font-weight: 600;
            font-size: 16px;
            color: #555;
        }

        .nav-item:hover {
            background: #e9ecef;
            color: #4A90E2;
        }

        .nav-item.active {
            background: white;
            color: #4A90E2;
            border-bottom-color: #4A90E2;
        }

        .tab-content {
            display: none;
            padding: 30px;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .stats-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        .stat-card h3 {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .stat-card .value {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-card .label {
            font-size: 12px;
            opacity: 0.8;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }

        .chart-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .chart-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }

        .chart-card h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }

        .chart-container {
            position: relative;
            height: 350px;
        }

        .controls {
            margin-bottom: 25px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }

        .search-box {
            flex: 1;
            min-width: 250px;
        }

        .search-box input {
            width: 100%;
            padding: 12px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            font-size: 15px;
            transition: all 0.3s ease;
        }

        .search-box input:focus {
            outline: none;
            border-color: #4A90E2;
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
        }

        .filter-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        select {
            padding: 10px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        select:hover {
            border-color: #4A90E2;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .btn-primary {
            background: #4A90E2;
            color: white;
        }

        .btn-primary:hover {
            background: #357ABD;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        thead {
            background: linear-gradient(135deg, #4A90E2 0%, #357ABD 100%);
            color: white;
        }

        th {
            padding: 18px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            cursor: pointer;
            user-select: none;
            position: relative;
        }

        th:hover {
            background: rgba(255,255,255,0.1);
        }

        th.sortable::after {
            content: 'â‡…';
            position: absolute;
            right: 8px;
            opacity: 0.5;
        }

        th.sort-asc::after {
            content: 'â†‘';
            opacity: 1;
        }

        th.sort-desc::after {
            content: 'â†“';
            opacity: 1;
        }

        td {
            padding: 15px 18px;
            border-bottom: 1px solid #f0f0f0;
            color: #333;
        }

        tbody tr {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        tbody tr:nth-child(even) {
            background: #f8f9fa;
        }

        tbody tr:hover {
            background: #e3f2fd;
            transform: scale(1.01);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .badge-large { background: #e3f2fd; color: #1976d2; }
        .badge-mid { background: #f3e5f5; color: #7b1fa2; }
        .badge-small { background: #fff3e0; color: #e65100; }
        .badge-foreign { background: #e8f5e9; color: #2e7d32; }

        .company-link {
            color: #4A90E2;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .company-link:hover {
            color: #357ABD;
            text-decoration: underline;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .modal-header h2 {
            color: #333;
            font-size: 24px;
        }

        .close-btn {
            font-size: 28px;
            cursor: pointer;
            color: #999;
            transition: color 0.3s ease;
        }

        .close-btn:hover {
            color: #333;
        }

        .modal-body {
            line-height: 1.8;
        }

        .modal-body .info-row {
            display: flex;
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 8px;
            background: #f8f9fa;
        }

        .modal-body .info-label {
            font-weight: 600;
            color: #4A90E2;
            min-width: 120px;
        }

        .modal-body .info-value {
            color: #333;
            flex: 1;
        }

        .top-companies-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .company-item {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s ease;
        }

        .company-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.12);
        }

        .company-rank {
            font-size: 28px;
            font-weight: bold;
            color: #4A90E2;
            min-width: 50px;
        }

        .company-info {
            flex: 1;
        }

        .company-name {
            font-weight: 600;
            font-size: 16px;
            color: #333;
            margin-bottom: 5px;
        }

        .company-count {
            color: #666;
            font-size: 14px;
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 30px;
            padding: 20px;
        }

        .pagination button {
            padding: 10px 20px;
            border: 2px solid #4A90E2;
            background: white;
            color: #4A90E2;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .pagination button:hover:not(:disabled) {
            background: #4A90E2;
            color: white;
        }

        .pagination button:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .pagination .page-info {
            color: #666;
            font-weight: 600;
        }

        .alert {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 3000;
            animation: slideIn 0.3s ease;
            display: none;
        }

        .alert.show {
            display: block;
        }

        @keyframes slideIn {
            from { transform: translateX(400px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border-left: 4px solid #28a745;
        }

        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border-left: 4px solid #dc3545;
        }

        .loading {
            text-align: center;
            padding: 50px;
            font-size: 18px;
            color: #666;
        }

        .loading::after {
            content: '...';
            animation: dots 1.5s steps(4, end) infinite;
        }

        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }

        #fileInput {
            display: none;
        }

        @media (max-width: 768px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }

            .nav-item {
                padding: 15px 10px;
                font-size: 14px;
            }

            .header h1 {
                font-size: 1.8em;
            }

            .stats-overview {
                grid-template-columns: repeat(2, 1fr);
            }

            .filter-group {
                width: 100%;
            }

            select {
                flex: 1;
            }

            .controls {
                flex-direction: column;
            }

            .action-buttons {
                width: 100%;
            }

            .btn {
                flex: 1;
            }

            table {
                font-size: 12px;
            }

            th, td {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“Š UniJob View2</h1>
            <p>ì±„ìš© ë°ì´í„° ë¶„ì„ ë° ì‹œê°í™” í”Œë«í¼</p>
        </div>

        <div class="file-upload-bar">
            <button class="file-upload-btn" onclick="document.getElementById('fileInput').click()">
                ğŸ“‚ JSON íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°
            </button>
            <input type="file" id="fileInput" accept=".json" onchange="loadJSONFile(event)">
            <span class="file-name" id="fileName">íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”</span>
            <span class="data-count" id="dataCount">ë°ì´í„°: 0ê°œ</span>
        </div>

        <div class="nav-menu">
            <div class="nav-item active" onclick="showTab('data')">
                ğŸ“‹ ë°ì´í„°
            </div>
            <div class="nav-item" onclick="showTab('statistics')">
                ğŸ“Š í†µê³„ ëŒ€ì‹œë³´ë“œ
            </div>
            <div class="nav-item" onclick="showTab('companies')">
                ğŸ¢ ê¸°ì—… ë¶„ì„
            </div>
            <div class="nav-item" onclick="showTab('trends')">
                ğŸ“ˆ íŠ¸ë Œë“œ ë¶„ì„
            </div>
        </div>

        <div id="data-tab" class="tab-content active">
            <div class="controls">
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="ğŸ” ê¸°ì—…ëª…, ì§ë¬´, ì§€ì—­, ì‚°ì—… ê²€ìƒ‰..." onkeyup="filterTable()">
                </div>
                <div class="filter-group">
                    <select id="industryFilter" onchange="filterTable()">
                        <option value="">ì „ì²´ ì‚°ì—…</option>
                    </select>
                    <select id="locationFilter" onchange="filterTable()">
                        <option value="">ì „ì²´ ì§€ì—­</option>
                    </select>
                    <select id="sizeFilter" onchange="filterTable()">
                        <option value="">ì „ì²´ ê·œëª¨</option>
                    </select>
                    <select id="jobTypeFilter" onchange="filterTable()">
                        <option value="">ì „ì²´ ê³ ìš©í˜•íƒœ</option>
                    </select>
                </div>
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="downloadCSV()">ğŸ“¥ CSV ë‹¤ìš´ë¡œë“œ</button>
                    <button class="btn btn-success" onclick="downloadJSON()">ğŸ“¦ JSON ë‹¤ìš´ë¡œë“œ</button>
                    <button class="btn btn-secondary" onclick="resetFilters()">ğŸ”„ ì´ˆê¸°í™”</button>
                </div>
            </div>

            <table id="dataTable">
                <thead>
                    <tr>
                        <th class="sortable" onclick="sortTable(0)">ê¸°ì—…ëª…</th>
                        <th class="sortable" onclick="sortTable(1)">ì§ë¬´</th>
                        <th class="sortable" onclick="sortTable(2)">ê·œëª¨</th>
                        <th class="sortable" onclick="sortTable(3)">ì‚°ì—…</th>
                        <th class="sortable" onclick="sortTable(4)">ì§€ì—­</th>
                        <th class="sortable" onclick="sortTable(5)">ê³ ìš©í˜•íƒœ</th>
                        <th class="sortable" onclick="sortTable(6)">ë§ˆê°ì¼</th>
                        <th>ìƒì„¸</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <tr>
                        <td colspan="8" class="loading">JSON íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì„¸ìš”</td>
                    </tr>
                </tbody>
            </table>

            <div class="pagination">
                <button id="prevBtn" onclick="changePage(-1)">ì´ì „</button>
                <span class="page-info" id="pageInfo">0 / 0</span>
                <button id="nextBtn" onclick="changePage(1)">ë‹¤ìŒ</button>
            </div>
        </div>

        <div id="statistics-tab" class="tab-content">
            <div class="stats-overview">
                <div class="stat-card">
                    <h3>ì´ ì±„ìš©ê³µê³ </h3>
                    <div class="value" id="totalJobs">0</div>
                    <div class="label">ê±´</div>
                </div>
                <div class="stat-card">
                    <h3>ì°¸ì—¬ ê¸°ì—…</h3>
                    <div class="value" id="totalCompanies">0</div>
                    <div class="label">ê°œì‚¬</div>
                </div>
                <div class="stat-card">
                    <h3>ì£¼ìš” ì‚°ì—…</h3>
                    <div class="value" id="topIndustry">-</div>
                    <div class="label">ë¶„ì•¼</div>
                </div>
                <div class="stat-card">
                    <h3>ì±„ìš© ì§€ì—­</h3>
                    <div class="value" id="totalLocations">0</div>
                    <div class="label">ê°œ ì§€ì—­</div>
                </div>
            </div>

            <div class="charts-grid">
                <div class="chart-card">
                    <h3>ğŸ“Š ì‚°ì—…ë³„ ì±„ìš© ë¶„í¬</h3>
                    <div class="chart-container">
                        <canvas id="industryChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <h3>ğŸ¢ ê¸°ì—… ê·œëª¨ë³„ ë¶„í¬</h3>
                    <div class="chart-container">
                        <canvas id="sizeChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <h3>ğŸ—ºï¸ ì§€ì—­ë³„ ì±„ìš© í˜„í™©</h3>
                    <div class="chart-container">
                        <canvas id="locationChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <h3>ğŸ’¼ ê³ ìš© í˜•íƒœ ë¶„í¬</h3>
                    <div class="chart-container">
                        <canvas id="jobTypeChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <h3>ğŸ“… ì›”ë³„ ì±„ìš© ì¶”ì´</h3>
                    <div class="chart-container">
                        <canvas id="monthlyChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <h3>ğŸ” ì¸ê¸° í‚¤ì›Œë“œ TOP 10</h3>
                    <div class="chart-container">
                        <canvas id="keywordChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <div id="companies-tab" class="tab-content">
            <div class="chart-card">
                <h3>ğŸ† TOP 20 ì±„ìš© ê¸°ì—…</h3>
                <div id="topCompaniesList" class="top-companies-list">
                    <div class="loading">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì„¸ìš”</div>
                </div>
            </div>

            <div class="charts-grid" style="margin-top: 30px;">
                <div class="chart-card">
                    <h3>ğŸ“Š ê¸°ì—…ë³„ ì±„ìš© ê³µê³  ìˆ˜</h3>
                    <div class="chart-container">
                        <canvas id="companyChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <h3>ğŸ”„ ì‚°ì—… Ã— ê¸°ì—…ê·œëª¨ ë¶„í¬</h3>
                    <div class="chart-container">
                        <canvas id="crossChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <div id="trends-tab" class="tab-content">
            <div class="charts-grid">
                <div class="chart-card">
                    <h3>ğŸ“… ìˆ˜ì§‘ ì‹œê¸°ë³„ ì±„ìš© ì¶”ì´</h3>
                    <div class="chart-container">
                        <canvas id="collectionChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <h3>â° ë§ˆê° ê¸°í•œ ë¶„í¬</h3>
                    <div class="chart-container">
                        <canvas id="deadlineChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <h3>ğŸ“ˆ ë°ì´í„° í’ˆì§ˆ ì ìˆ˜</h3>
                    <div class="chart-container">
                        <canvas id="qualityChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <h3>ğŸ‘¥ ì§ì› ê·œëª¨ ë¶„í¬</h3>
                    <div class="chart-container">
                        <canvas id="employeeChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="detailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ì±„ìš© ìƒì„¸ ì •ë³´</h2>
                <span class="close-btn" onclick="closeModal()">&times;</span>
            </div>
            <div class="modal-body" id="modalBody"></div>
        </div>
    </div>

    <div id="alertBox" class="alert"></div>

    <script>
        let jobsData = [];
        let filteredData = [];
        let charts = {};
        let currentPage = 1;
        let sortColumn = -1;
        let sortDirection = 'asc';
        const itemsPerPage = 50;

        function loadJSONFile(event) {
            const file = event.target.files[0];
            if (!file) return;

            document.getElementById('fileName').textContent = file.name;
            
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    jobsData = JSON.parse(e.target.result);
                    filteredData = [...jobsData];
                    initializeAll();
                    showAlert(`âœ… ${jobsData.length.toLocaleString()}ê°œ ë°ì´í„° ë¡œë“œ ì™„ë£Œ!`, 'success');
                    document.getElementById('dataCount').textContent = `ë°ì´í„°: ${jobsData.length.toLocaleString()}ê°œ`;
                } catch (error) {
                    showAlert('âŒ JSON íŒŒì¼ íŒŒì‹± ì˜¤ë¥˜: ' + error.message, 'error');
                }
            };
            reader.readAsText(file, 'utf-8');
        }

        function initializeAll() {
            populateFilters();
            renderTable();
            calculateStats();
        }

        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });

            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');

            if (tabName === 'statistics' && !charts.industry) {
                createStatisticsCharts();
            } else if (tabName === 'companies' && !charts.company) {
                createCompanyCharts();
            } else if (tabName === 'trends' && !charts.collection) {
                createTrendCharts();
            }
        }

        function populateFilters() {
            const industries = [...new Set(jobsData.map(j => j.industry).filter(x => x))].sort();
            const locations = [...new Set(jobsData.map(j => j.location).filter(x => x))].sort();
            const sizes = [...new Set(jobsData.map(j => j.companySize).filter(x => x))].sort();
            const jobTypes = [...new Set(jobsData.map(j => j.jobType).filter(x => x))].sort();

            populateSelect('industryFilter', industries);
            populateSelect('locationFilter', locations);
            populateSelect('sizeFilter', sizes);
            populateSelect('jobTypeFilter', jobTypes);
        }

        function populateSelect(id, options) {
            const select = document.getElementById(id);
            select.innerHTML = '<option value="">ì „ì²´</option>';
            options.forEach(opt => {
                const option = document.createElement('option');
                option.value = opt;
                option.textContent = opt;
                select.appendChild(option);
            });
        }

        function renderTable() {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';

            const start = (currentPage - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            const pageData = filteredData.slice(start, end);

            if (pageData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="8" style="text-align:center;padding:50px;color:#999;">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                updatePagination();
                return;
            }

            pageData.forEach((job, index) => {
                const row = document.createElement('tr');
                row.onclick = () => showDetail(job);
                
                const sizeClass = job.companySize.includes('Large') ? 'badge-large' :
                                 job.companySize.includes('Mid') ? 'badge-mid' :
                                 job.companySize.includes('Small') ? 'badge-small' :
                                 job.companySize.includes('Foreign') ? 'badge-foreign' : '';

                row.innerHTML = `
                    <td><a href="${job.jobUrl || '#'}" class="company-link" target="_blank" onclick="event.stopPropagation()">${job.companyName || 'ë¯¸ë“±ë¡'}</a></td>
                    <td>${(job.jobTitle || '').substring(0, 60)}${(job.jobTitle || '').length > 60 ? '...' : ''}</td>
                    <td><span class="badge ${sizeClass}">${job.companySize || 'ë¯¸ë“±ë¡'}</span></td>
                    <td>${job.industry || 'ë¯¸ë“±ë¡'}</td>
                    <td>${job.location || 'ë¯¸ë“±ë¡'}</td>
                    <td>${job.jobType || 'ë¯¸ë“±ë¡'}</td>
                    <td>${job.deadline || 'ë¯¸ì •'}</td>
                    <td><button class="btn btn-primary" style="padding: 5px 10px; font-size: 12px;" onclick="event.stopPropagation(); showDetail(filteredData[${start + index}])">ìƒì„¸</button></td>
                `;
                tbody.appendChild(row);
            });

            updatePagination();
        }

        function showDetail(job) {
            const modal = document.getElementById('detailModal');
            const modalBody = document.getElementById('modalBody');
            
            modalBody.innerHTML = `
                <div class="info-row">
                    <div class="info-label">ID</div>
                    <div class="info-value">${job.id || '-'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">ê¸°ì—…ëª…</div>
                    <div class="info-value">${job.companyName || 'ë¯¸ë“±ë¡'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">ì§ë¬´</div>
                    <div class="info-value">${job.jobTitle || 'ë¯¸ë“±ë¡'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">ê¸°ì—… ê·œëª¨</div>
                    <div class="info-value">${job.companySize || 'ë¯¸ë“±ë¡'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">ê¸°ì—… ìœ í˜•</div>
                    <div class="info-value">${job.companyType || 'ë¯¸ë“±ë¡'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">ì‚°ì—…</div>
                    <div class="info-value">${job.industry || 'ë¯¸ë“±ë¡'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">ì§ì› ìˆ˜</div>
                    <div class="info-value">${job.employeeCount || 'ë¯¸ë“±ë¡'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">ì§€ì—­</div>
                    <div class="info-value">${job.location || 'ë¯¸ë“±ë¡'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">ê³ ìš© í˜•íƒœ</div>
                    <div class="info-value">${job.jobType || 'ë¯¸ë“±ë¡'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">ë§ˆê°ì¼</div>
                    <div class="info-value">${job.deadline || 'ë¯¸ì •'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">ê¸‰ì—¬</div>
                    <div class="info-value">${job.salary || 'í˜‘ì˜'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">í‚¤ì›Œë“œ</div>
                    <div class="info-value">${job.keywordMatched || '-'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">ìˆ˜ì§‘ ì‹œê°„</div>
                    <div class="info-value">${job.collectionTime || '-'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">ì±„ìš© URL</div>
                    <div class="info-value"><a href="${job.jobUrl || '#'}" target="_blank" class="company-link">ë§í¬ ì—´ê¸°</a></div>
                </div>
            `;
            
            modal.classList.add('active');
        }

        function closeModal() {
            document.getElementById('detailModal').classList.remove('active');
        }

        window.onclick = function(event) {
            const modal = document.getElementById('detailModal');
            if (event.target === modal) {
                closeModal();
            }
        }

        function sortTable(columnIndex) {
            if (sortColumn === columnIndex) {
                sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                sortColumn = columnIndex;
                sortDirection = 'asc';
            }

            const columns = ['companyName', 'jobTitle', 'companySize', 'industry', 'location', 'jobType', 'deadline'];
            const column = columns[columnIndex];

            filteredData.sort((a, b) => {
                let valA = a[column] || '';
                let valB = b[column] || '';
                
                if (sortDirection === 'asc') {
                    return valA.localeCompare(valB);
                } else {
                    return valB.localeCompare(valA);
                }
            });

            document.querySelectorAll('th').forEach((th, index) => {
                th.classList.remove('sort-asc', 'sort-desc');
                if (index === columnIndex) {
                    th.classList.add(sortDirection === 'asc' ? 'sort-asc' : 'sort-desc');
                }
            });

            currentPage = 1;
            renderTable();
        }

        function updatePagination() {
            const totalPages = Math.ceil(filteredData.length / itemsPerPage);
            document.getElementById('pageInfo').textContent = `${currentPage} / ${totalPages || 1}`;
            document.getElementById('prevBtn').disabled = currentPage === 1;
            document.getElementById('nextBtn').disabled = currentPage === totalPages || totalPages === 0;
        }

        function changePage(direction) {
            const totalPages = Math.ceil(filteredData.length / itemsPerPage);
            const newPage = currentPage + direction;
            
            if (newPage >= 1 && newPage <= totalPages) {
                currentPage = newPage;
                renderTable();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function filterTable() {
            const searchText = document.getElementById('searchInput').value.toLowerCase();
            const industryFilter = document.getElementById('industryFilter').value;
            const locationFilter = document.getElementById('locationFilter').value;
            const sizeFilter = document.getElementById('sizeFilter').value;
            const jobTypeFilter = document.getElementById('jobTypeFilter').value;

            filteredData = jobsData.filter(job => {
                const matchSearch = !searchText || 
                    (job.companyName || '').toLowerCase().includes(searchText) ||
                    (job.jobTitle || '').toLowerCase().includes(searchText) ||
                    (job.location || '').toLowerCase().includes(searchText) ||
                    (job.industry || '').toLowerCase().includes(searchText);
                
                const matchIndustry = !industryFilter || job.industry === industryFilter;
                const matchLocation = !locationFilter || job.location === locationFilter;
                const matchSize = !sizeFilter || job.companySize === sizeFilter;
                const matchJobType = !jobTypeFilter || job.jobType === jobTypeFilter;

                return matchSearch && matchIndustry && matchLocation && matchSize && matchJobType;
            });

            currentPage = 1;
            renderTable();
        }

        function resetFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('industryFilter').value = '';
            document.getElementById('locationFilter').value = '';
            document.getElementById('sizeFilter').value = '';
            document.getElementById('jobTypeFilter').value = '';
            filterTable();
        }

        function downloadCSV() {
            const headers = ['ID', 'ê¸°ì—…ëª…', 'ì§ë¬´', 'ê·œëª¨', 'ìœ í˜•', 'ì‚°ì—…', 'ì§ì›ìˆ˜', 'ì§€ì—­', 'ê³ ìš©í˜•íƒœ', 'ë§ˆê°ì¼', 'ê¸‰ì—¬', 'URL', 'í‚¤ì›Œë“œ', 'ìˆ˜ì§‘ì‹œê°„'];
            const csvContent = [
                headers.join(','),
                ...filteredData.map(job => [
                    job.id,
                    job.companyName,
                    job.jobTitle,
                    job.companySize,
                    job.companyType,
                    job.industry,
                    job.employeeCount,
                    job.location,
                    job.jobType,
                    job.deadline,
                    job.salary,
                    job.jobUrl,
                    job.keywordMatched,
                    job.collectionTime
                ].map(field => `"${field || ''}"`).join(','))
            ].join('\n');

            const BOM = '\uFEFF';
            const blob = new Blob([BOM + csvContent], { type: 'text/csv;charset=utf-8;' });
            downloadBlob(blob, `unijob_filtered_${Date.now()}.csv`);
            showAlert('âœ… CSV íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ!', 'success');
        }

        function downloadJSON() {
            const jsonString = JSON.stringify(filteredData, null, 2);
            const blob = new Blob([jsonString], { type: 'application/json' });
            downloadBlob(blob, `unijob_filtered_${Date.now()}.json`);
            showAlert('âœ… JSON íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ!', 'success');
        }

        function downloadBlob(blob, filename) {
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            link.click();
            URL.revokeObjectURL(url);
        }

        function calculateStats() {
            const totalJobs = jobsData.length;
            const uniqueCompanies = [...new Set(jobsData.map(j => j.companyName).filter(x => x))].length;
            const uniqueLocations = [...new Set(jobsData.map(j => j.location).filter(x => x))].length;
            
            const industryCounts = {};
            jobsData.forEach(job => {
                if (job.industry) {
                    industryCounts[job.industry] = (industryCounts[job.industry] || 0) + 1;
                }
            });
            
            const topIndustry = Object.keys(industryCounts).length > 0 ?
                Object.keys(industryCounts).reduce((a, b) => industryCounts[a] > industryCounts[b] ? a : b) : '-';

            document.getElementById('totalJobs').textContent = totalJobs.toLocaleString();
            document.getElementById('totalCompanies').textContent = uniqueCompanies.toLocaleString();
            document.getElementById('topIndustry').textContent = topIndustry;
            document.getElementById('totalLocations').textContent = uniqueLocations;
        }

        function createStatisticsCharts() {
            createIndustryChart();
            createSizeChart();
            createLocationChart();
            createJobTypeChart();
            createMonthlyChart();
            createKeywordChart();
        }

        function createIndustryChart() {
            const industryCounts = {};
            jobsData.forEach(job => {
                if (job.industry) {
                    industryCounts[job.industry] = (industryCounts[job.industry] || 0) + 1;
                }
            });

            const ctx = document.getElementById('industryChart');
            charts.industry = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: Object.keys(industryCounts),
                    datasets: [{
                        data: Object.values(industryCounts),
                        backgroundColor: [
                            '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0',
                            '#9966FF', '#FF9F40', '#FF6384', '#C9CBCF', '#4BC0C0'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'right' } }
                }
            });
        }

        function createSizeChart() {
            const sizeCounts = {};
            jobsData.forEach(job => {
                if (job.companySize) {
                    sizeCounts[job.companySize] = (sizeCounts[job.companySize] || 0) + 1;
                }
            });

            const ctx = document.getElementById('sizeChart');
            charts.size = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(sizeCounts),
                    datasets: [{
                        data: Object.values(sizeCounts),
                        backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'right' } }
                }
            });
        }

        function createLocationChart() {
            const locationCounts = {};
            jobsData.forEach(job => {
                if (job.location) {
                    locationCounts[job.location] = (locationCounts[job.location] || 0) + 1;
                }
            });

            const sortedLocations = Object.entries(locationCounts)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10);

            const ctx = document.getElementById('locationChart');
            charts.location = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: sortedLocations.map(l => l[0]),
                    datasets: [{
                        label: 'ì±„ìš© ê³µê³  ìˆ˜',
                        data: sortedLocations.map(l => l[1]),
                        backgroundColor: '#4A90E2'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { y: { beginAtZero: true } }
                }
            });
        }

        function createJobTypeChart() {
            const typeCounts = {};
            jobsData.forEach(job => {
                if (job.jobType) {
                    typeCounts[job.jobType] = (typeCounts[job.jobType] || 0) + 1;
                }
            });

            const ctx = document.getElementById('jobTypeChart');
            charts.jobType = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: Object.keys(typeCounts),
                    datasets: [{
                        data: Object.values(typeCounts),
                        backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#FF9F40']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'right' } }
                }
            });
        }

        function createMonthlyChart() {
            const monthlyCounts = {};
            jobsData.forEach(job => {
                if (job.collectionTime) {
                    const date = new Date(job.collectionTime);
                    const month = date.getMonth() + 1;
                    monthlyCounts[month] = (monthlyCounts[month] || 0) + 1;
                }
            });

            const months = Array.from({length: 12}, (_, i) => i + 1);
            const data = months.map(m => monthlyCounts[m] || 0);

            const ctx = document.getElementById('monthlyChart');
            charts.monthly = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: months.map(m => m + 'ì›”'),
                    datasets: [{
                        label: 'ì±„ìš© ê³µê³  ìˆ˜',
                        data: data,
                        borderColor: '#4A90E2',
                        backgroundColor: 'rgba(74, 144, 226, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { y: { beginAtZero: true } }
                }
            });
        }

        function createKeywordChart() {
            const keywordCounts = {};
            jobsData.forEach(job => {
                if (job.keywordMatched) {
                    keywordCounts[job.keywordMatched] = (keywordCounts[job.keywordMatched] || 0) + 1;
                }
            });

            const sortedKeywords = Object.entries(keywordCounts)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10);

            const ctx = document.getElementById('keywordChart');
            charts.keyword = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: sortedKeywords.map(k => k[0]),
                    datasets: [{
                        label: 'ë§¤ì¹­ ìˆ˜',
                        data: sortedKeywords.map(k => k[1]),
                        backgroundColor: '#9966FF'
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { x: { beginAtZero: true } }
                }
            });
        }

        function createCompanyCharts() {
            const companyCounts = {};
            jobsData.forEach(job => {
                if (job.companyName) {
                    companyCounts[job.companyName] = (companyCounts[job.companyName] || 0) + 1;
                }
            });

            const sortedCompanies = Object.entries(companyCounts)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 20);

            const listContainer = document.getElementById('topCompaniesList');
            listContainer.innerHTML = '';
            
            sortedCompanies.forEach(([company, count], index) => {
                const item = document.createElement('div');
                item.className = 'company-item';
                item.innerHTML = `
                    <div class="company-rank">#${index + 1}</div>
                    <div class="company-info">
                        <div class="company-name">${company}</div>
                        <div class="company-count">${count}ê°œ ì±„ìš©ê³µê³ </div>
                    </div>
                `;
                listContainer.appendChild(item);
            });

            const ctx = document.getElementById('companyChart');
            charts.company = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: sortedCompanies.map(c => c[0]),
                    datasets: [{
                        label: 'ì±„ìš© ê³µê³  ìˆ˜',
                        data: sortedCompanies.map(c => c[1]),
                        backgroundColor: '#FF6384'
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { x: { beginAtZero: true } }
                }
            });

            createCrossAnalysisChart();
        }

        function createCrossAnalysisChart() {
            const crossData = {};
            jobsData.forEach(job => {
                if (job.industry && job.companySize) {
                    const key = `${job.industry}_${job.companySize}`;
                    crossData[key] = (crossData[key] || 0) + 1;
                }
            });

            const industries = [...new Set(jobsData.map(j => j.industry).filter(x => x))].slice(0, 6);
            const sizes = [...new Set(jobsData.map(j => j.companySize).filter(x => x))].slice(0, 4);

            const datasets = sizes.map((size, index) => ({
                label: size,
                data: industries.map(ind => crossData[`${ind}_${size}`] || 0),
                backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0'][index]
            }));

            const ctx = document.getElementById('crossChart');
            charts.cross = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: industries,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'top' } },
                    scales: { y: { beginAtZero: true } }
                }
            });
        }

        function createTrendCharts() {
            createCollectionChart();
            createDeadlineChart();
            createQualityChart();
            createEmployeeChart();
        }

        function createCollectionChart() {
            const collectionDates = {};
            jobsData.forEach(job => {
                if (job.collectionTime) {
                    const date = job.collectionTime.split(' ')[0];
                    collectionDates[date] = (collectionDates[date] || 0) + 1;
                }
            });

            const sortedDates = Object.entries(collectionDates).sort();

            const ctx = document.getElementById('collectionChart');
            charts.collection = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: sortedDates.map(d => d[0]),
                    datasets: [{
                        label: 'ìˆ˜ì§‘ ê³µê³  ìˆ˜',
                        data: sortedDates.map(d => d[1]),
                        borderColor: '#36A2EB',
                        backgroundColor: 'rgba(54, 162, 235, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { y: { beginAtZero: true } }
                }
            });
        }

        function createDeadlineChart() {
            const deadlineCounts = {
                'D-7 ì´ë‚´': 0,
                'D-14 ì´ë‚´': 0,
                'D-30 ì´ë‚´': 0,
                'ìƒì‹œì±„ìš©': 0,
                'ë¯¸ì •': 0
            };

            jobsData.forEach(job => {
                if (!job.deadline || job.deadline.includes('TBD')) {
                    deadlineCounts['ë¯¸ì •']++;
                } else if (job.deadline.includes('D-')) {
                    const match = job.deadline.match(/D-(\d+)/);
                    if (match) {
                        const days = parseInt(match[1]);
                        if (days <= 7) deadlineCounts['D-7 ì´ë‚´']++;
                        else if (days <= 14) deadlineCounts['D-14 ì´ë‚´']++;
                        else if (days <= 30) deadlineCounts['D-30 ì´ë‚´']++;
                        else deadlineCounts['ìƒì‹œì±„ìš©']++;
                    }
                } else {
                    deadlineCounts['ìƒì‹œì±„ìš©']++;
                }
            });

            const ctx = document.getElementById('deadlineChart');
            charts.deadline = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(deadlineCounts),
                    datasets: [{
                        data: Object.values(deadlineCounts),
                        backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'right' } }
                }
            });
        }

        function createQualityChart() {
            const total = jobsData.length;
            const quality = {
                'íšŒì‚¬ëª…': jobsData.filter(j => j.companyName && j.companyName !== 'Company TBD').length / total * 100,
                'ì—°ë´‰ì •ë³´': jobsData.filter(j => j.salary && j.salary !== 'Salary TBD').length / total * 100,
                'ë§ˆê°ì¼': jobsData.filter(j => j.deadline && j.deadline !== 'Deadline TBD').length / total * 100,
                'ì§ì›ìˆ˜': jobsData.filter(j => j.employeeCount && j.employeeCount !== 'Unknown').length / total * 100
            };

            const ctx = document.getElementById('qualityChart');
            charts.quality = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: Object.keys(quality),
                    datasets: [{
                        label: 'ì •ë³´ ì™„ì„±ë„ (%)',
                        data: Object.values(quality),
                        backgroundColor: 'rgba(74, 144, 226, 0.2)',
                        borderColor: '#4A90E2',
                        pointBackgroundColor: '#4A90E2'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            ticks: { stepSize: 20 }
                        }
                    }
                }
            });
        }

        function createEmployeeChart() {
            const employeeCounts = {};
            jobsData.forEach(job => {
                if (job.employeeCount && job.employeeCount !== 'Unknown') {
                    employeeCounts[job.employeeCount] = (employeeCounts[job.employeeCount] || 0) + 1;
                }
            });

            const sortedEmployees = Object.entries(employeeCounts)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10);

            const ctx = document.getElementById('employeeChart');
            charts.employee = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: sortedEmployees.map(e => e[0]),
                    datasets: [{
                        label: 'ê¸°ì—… ìˆ˜',
                        data: sortedEmployees.map(e => e[1]),
                        backgroundColor: '#FFCE56'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { y: { beginAtZero: true } }
                }
            });
        }

        function showAlert(message, type) {
            const alertBox = document.getElementById('alertBox');
            alertBox.className = `alert alert-${type} show`;
            alertBox.textContent = message;
            
            setTimeout(() => {
                alertBox.classList.remove('show');
            }, 3000);
        }
    </script>
</body>
</html>